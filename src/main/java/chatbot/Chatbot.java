package chatbot;import chatbot.exception.*;import chatbot.task.Deadline;import chatbot.task.Event;import chatbot.task.Task;import chatbot.task.Todo;import java.time.format.DateTimeParseException;import java.util.List;public class Chatbot {    /** Name of the Chatbot. */    private static final String NAME = "Bro";    /** TaskList for the Chatbot. */    private TaskList taskList;    /** Ui for the Chatbot. */    private Ui ui;    /** Storage for the Chatbot. */    private Storage storage;    /** Parser for the Chatbot. */    private Parser parser;    /**     * Constructor for the Chatbot.     */    private Chatbot() {        this.taskList = new TaskList();        this.ui = new Ui(NAME);        this.storage = new Storage();        this.parser = new Parser();    }    /**     * Greets the user.     */    private void greet() {        this.ui.greet();    }    /**     * Causes Chatbot to exit.     */    private void exit() {        this.ui.exit();    }    /**     * Adds task inputted by user to taskList. Prints out confirmation.     *     * @param input The command inputted by the user.     * @throws InvalidTodoException If format of chatbot.task.Todo entered is invalid.     * @throws InvalidDeadlineException If format of Deadline entered is invalid.     * @throws InvalidEventException If format of chatbot.task.Event entered is invalid.     * @throws InvalidCommandException If format of command entered is invalid.     */    private void add(String input) throws InvalidTodoException,            InvalidDeadlineException, InvalidEventException, InvalidCommandException {        Task newTask;        List<String> taskArr = this.parser.parseAdd(input);        String type = taskArr.get(0);        if (type.equals("todo")) {            String description = taskArr.get(1);            newTask = new Todo(description);        } else if (type.equals("deadline")) {            try {                String description = taskArr.get(1);                String deadline = taskArr.get(2);                newTask = new Deadline(description, deadline);            } catch (DateTimeParseException e) {                throw new InvalidDeadlineException();            }        } else {            try {                String description = taskArr.get(1);                String start = taskArr.get(2);                String end = taskArr.get(3);                newTask = new Event(description, start, end);            } catch (DateTimeParseException e) {                throw new InvalidEventException();            }        }        this.taskList.add(newTask);        this.ui.printAddConfirmation(this.taskList);    }    /**     * Lists out all the tasks in taskList.     */    private void listTasks() {        this.ui.listTasks(this.taskList);    }    /**     * Marks specified task as done. Prints confirmation.     *     * @param input The user input.     * @throws InvalidTaskNumberException If there is no task with the task number in the taskList.     * @throws InvalidCommandException If format of command entered is invalid.     */    private void markTaskStatusTrue(String input) throws InvalidTaskNumberException, InvalidCommandException {        int taskNum = parser.parseMarkTaskStatusTrue(input);        if (taskNum > this.taskList.size()) {            throw new InvalidTaskNumberException(taskNum);        } else {            taskList.markTaskTrue(taskNum - 1);            this.ui.printMarkDoneConfirmation(taskNum - 1, this.taskList);        }    }    /**     * Marks specified task as undone. Prints confirmation.     *     * @param input The user input.     * @throws InvalidTaskNumberException If there is no task with the task number in the taskList.     * @throws InvalidCommandException If format of command entered is invalid.     */    private void markTaskStatusFalse(String input) throws InvalidTaskNumberException, InvalidCommandException {        int taskNum = parser.parseMarkTaskStatusFalse(input);        if (taskNum > this.taskList.size()) {            throw new InvalidTaskNumberException(taskNum);        } else {            taskList.markTaskFalse(taskNum - 1);            this.ui.printMarkUndoneConfirmation(taskNum - 1, this.taskList);        }    }    /**     * Deletes the specified task in the list.     *     * @param input The user input.     * @throws InvalidTaskNumberException If there is no task with the task number in the taskList.     * @throws InvalidCommandException If format of command entered is invalid.     */    public void delete(String input) throws InvalidTaskNumberException, InvalidCommandException {        int taskNum = parser.parseDelete(input);        this.taskList.delete(taskNum - 1);        this.ui.printDeleteConfirmation(taskNum - 1, this.taskList);    }    /**     * Loads file input and adds respective tasks into chatbot taskList.     */    private void loadTasksFromFile() {        try {            this.storage.loadTasksFromFile(this.taskList);        } catch (Exception e) {            this.ui.printExceptionMessage(e);        }    }    /**     * Reads user input. Exits if user input is "bye", lists tasks if input is "list", else, echoes commands.     * Update current state of tasks to data file.     */    private void readInput() {        String userInput = this.ui.getUserInput();        try {            if (userInput.equals("list")) {                this.listTasks();            } else if (userInput.equals("bye")) {                this.exit();            } else if (userInput.startsWith("add ")) {                this.add(userInput);            } else if (userInput.startsWith("mark ")) {                this.markTaskStatusTrue(userInput);            } else if (userInput.startsWith("unmark ")) {                this.markTaskStatusFalse(userInput);            } else if (userInput.startsWith("delete ")) {                this.delete(userInput);            } else {                throw new InvalidCommandException();            }            this.saveTasks();        } catch (Exception e) {            this.ui.printExceptionMessage(e);        } finally {            if (!userInput.equals("bye")) {                this.readInput();            }        }    }    /**     * Saves current taskList to data file.     */    public void saveTasks() {        try {            this.storage.saveTasks(this.taskList);        } catch (Exception e) {            this.ui.printExceptionMessage(e);        }    }    public static void main(String[] args) {        Chatbot chatbot = new Chatbot();        chatbot.loadTasksFromFile();        chatbot.greet();        chatbot.readInput();    }}